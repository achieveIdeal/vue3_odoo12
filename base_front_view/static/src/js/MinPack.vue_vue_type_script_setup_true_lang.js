import{f as e,t as o,u as t,g as a,h as l,j as s,k as n,l as r,r as d,b as u,d as i,P as c,i as p,a as m,F as f,E as y,_ as v,C as g,U as b,m as _,n as h,o as C,p as k,q as w,s as x,v as M,x as E,w as I,R as B,y as R,z as A,A as F,B as S}from"./RecordView.js";import{x as $,y as L,z as T,A as z,q as D,B as O,C as P,D as V,N as j,d as q,l as Y,r as N,E as U,G as X,c as H,o as G,a as J,h as K,n as Q,u as W,t as Z,w as ee,i as oe,j as te,b as ae,e as le,H as se,p as ne,I as re,g as de,J as ue,L as ie,M as ce,O as pe,P as me,T as fe,Q as ye,R as ve,F as ge,S as be,k as _e,U as he}from"./index.js";const Ce=e=>{if(!e)return{onClick:j,onMousedown:j,onMouseup:j};let o=!1,t=!1;return{onClick:a=>{o&&t&&e(a),o=t=!1},onMousedown:e=>{o=e.target===e.currentTarget},onMouseup:e=>{t=e.target===e.currentTarget}}},ke=q({name:"ElOverlay",props:u({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:i([String,Array,Object])},zIndex:{type:i([String,Number])}}),emits:{click:e=>e instanceof MouseEvent},setup(e,{slots:o,emit:a}){const l=t("overlay"),{onClick:s,onMousedown:n,onMouseup:r}=Ce(e.customMaskEvent?void 0:e=>{a("click",e)});return()=>e.mask?Y("div",{class:[l.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:s,onMousedown:n,onMouseup:r},[N(o,"default")],c.STYLE|c.CLASS|c.PROPS,["onClick","onMouseup","onMousedown"]):U("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[N(o,"default")])}}),we=Symbol("dialogInjectionKey"),xe=u({center:{type:Boolean,default:!1},alignCenter:{type:Boolean,default:!1},closeIcon:{type:p},customClass:{type:String,default:""},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},title:{type:String,default:""}}),Me=["aria-label"],Ee=["id"],Ie=q({name:"ElDialogContent"});var Be=v(q({...Ie,props:xe,emits:{close:()=>!0},setup(o){const t=o,{t:a}=m(),{Close:l}=g,{dialogRef:s,headerRef:n,bodyId:r,ns:d,style:u}=X(we),{focusTrapRef:i}=X(f),c=((...e)=>o=>{e.forEach((e=>{$(e)?e(o):e.value=o}))})(i,s),p=H((()=>t.draggable));return((o,t,a)=>{let l={offsetX:0,offsetY:0};const s=t=>{const a=t.clientX,s=t.clientY,{offsetX:n,offsetY:r}=l,d=o.value.getBoundingClientRect(),u=d.left,i=d.top,c=d.width,p=d.height,m=document.documentElement.clientWidth,f=document.documentElement.clientHeight,y=-u+n,v=-i+r,g=m-u-c+n,b=f-i-p+r,_=t=>{const d=Math.min(Math.max(n+t.clientX-a,y),g),u=Math.min(Math.max(r+t.clientY-s,v),b);l={offsetX:d,offsetY:u},o.value.style.transform=`translate(${e(d)}, ${e(u)})`},h=()=>{document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",h)};document.addEventListener("mousemove",_),document.addEventListener("mouseup",h)},n=()=>{t.value&&o.value&&t.value.removeEventListener("mousedown",s)};L((()=>{T((()=>{a.value?t.value&&o.value&&t.value.addEventListener("mousedown",s):n()}))})),z((()=>{n()}))})(s,n,p),(e,o)=>(G(),J("div",{ref:W(c),class:Q([W(d).b(),W(d).is("fullscreen",e.fullscreen),W(d).is("draggable",W(p)),W(d).is("align-center",e.alignCenter),{[W(d).m("center")]:e.center},e.customClass]),style:le(W(u)),tabindex:"-1"},[K("header",{ref_key:"headerRef",ref:n,class:Q(W(d).e("header"))},[N(e.$slots,"header",{},(()=>[K("span",{role:"heading",class:Q(W(d).e("title"))},Z(e.title),3)])),e.showClose?(G(),J("button",{key:0,"aria-label":W(a)("el.dialog.close"),class:Q(W(d).e("headerbtn")),type:"button",onClick:o[0]||(o[0]=o=>e.$emit("close"))},[Y(W(y),{class:Q(W(d).e("close"))},{default:ee((()=>[(G(),oe(te(e.closeIcon||W(l))))])),_:1},8,["class"])],10,Me)):ae("v-if",!0)],2),K("div",{id:W(r),class:Q(W(d).e("body"))},[N(e.$slots,"default")],10,Ee),e.$slots.footer?(G(),J("footer",{key:0,class:Q(W(d).e("footer"))},[N(e.$slots,"footer")],2)):ae("v-if",!0)],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const Re=u({...xe,appendToBody:{type:Boolean,default:!1},beforeClose:{type:i(Function)},destroyOnClose:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:{type:Boolean,default:!1},modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1}}),Ae={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[b]:e=>_(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},Fe=["aria-label","aria-labelledby","aria-describedby"],Se=q({name:"ElDialog",inheritAttrs:!1}),$e=I(v(q({...Se,props:Re,emits:Ae,setup(u,{expose:i}){const c=u,p=de();M({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},H((()=>!!p.title))),M({scope:"el-dialog",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/dialog.html#attributes",type:"Attribute"},H((()=>!!c.customClass)));const m=t("dialog"),f=ne(),y=ne(),v=ne(),{visible:g,titleId:_,bodyId:I,style:B,overlayDialogStyle:R,rendered:A,zIndex:F,afterEnter:S,afterLeave:$,beforeLeave:T,handleClose:z,onModalClick:j,onOpenAutoFocus:q,onCloseAutoFocus:U,onCloseRequested:X,onFocusoutPrevented:J}=((u,i)=>{const c=se().emit,{nextZIndex:p}=h();let m="";const f=C(),y=C(),v=ne(!1),g=ne(!1),_=ne(!1),M=ne(u.zIndex||p());let E,I;const B=k("namespace",w),R=H((()=>{const o={},t=`--${B.value}-dialog`;return u.fullscreen||(u.top&&(o[`${t}-margin-top`]=u.top),u.width&&(o[`${t}-width`]=e(u.width))),o})),A=H((()=>u.alignCenter?{display:"flex"}:{}));function F(){null==I||I(),null==E||E(),u.openDelay&&u.openDelay>0?({stop:E}=x((()=>T()),u.openDelay)):T()}function S(){null==E||E(),null==I||I(),u.closeDelay&&u.closeDelay>0?({stop:I}=x((()=>z()),u.closeDelay)):z()}function $(){u.beforeClose?u.beforeClose((function(e){e||(g.value=!0,v.value=!1)})):S()}function T(){a&&(v.value=!0)}function z(){v.value=!1}return u.lockScroll&&((e,u={})=>{D(e)||o("[useLockscreen]","You need to pass a ref param to this function");const i=u.ns||t("popup"),c=O((()=>i.bm("parent","hidden")));if(!a||l(document.body,c.value))return;let p=0,m=!1,f="0";const y=()=>{setTimeout((()=>{d(null==document?void 0:document.body,c.value),m&&document&&(document.body.style.width=f)}),200)};P(e,(e=>{if(!e)return void y();m=!l(document.body,c.value),m&&(f=document.body.style.width),p=s(i.namespace.value);const o=document.documentElement.clientHeight<document.body.scrollHeight,t=n(document.body,"overflowY");p>0&&(o||"scroll"===t)&&m&&(document.body.style.width=`calc(100% - ${p}px)`),r(document.body,c.value)})),V((()=>y()))})(v),P((()=>u.modelValue),(e=>{e?(g.value=!1,F(),_.value=!0,M.value=u.zIndex?M.value++:p(),re((()=>{c("open"),i.value&&(i.value.scrollTop=0)}))):v.value&&S()})),P((()=>u.fullscreen),(e=>{i.value&&(e?(m=i.value.style.transform,i.value.style.transform=""):i.value.style.transform=m)})),L((()=>{u.modelValue&&(v.value=!0,_.value=!0,F())})),{afterEnter:function(){c("opened")},afterLeave:function(){c("closed"),c(b,!1),u.destroyOnClose&&(_.value=!1)},beforeLeave:function(){c("close")},handleClose:$,onModalClick:function(){u.closeOnClickModal&&$()},close:S,doClose:z,onOpenAutoFocus:function(){c("openAutoFocus")},onCloseAutoFocus:function(){c("closeAutoFocus")},onCloseRequested:function(){u.closeOnPressEscape&&$()},onFocusoutPrevented:function(e){var o;"pointer"===(null==(o=e.detail)?void 0:o.focusReason)&&e.preventDefault()},titleId:f,bodyId:y,closed:g,style:R,overlayDialogStyle:A,rendered:_,visible:v,zIndex:M}})(c,f);ue(we,{dialogRef:f,headerRef:y,bodyId:I,ns:m,rendered:A,style:B});const Z=Ce(j),te=H((()=>c.draggable&&!c.fullscreen));return i({visible:g,dialogContentRef:v}),(e,o)=>(G(),oe(ye,{to:"body",disabled:!e.appendToBody},[Y(fe,{name:"dialog-fade",onAfterEnter:W(S),onAfterLeave:W($),onBeforeLeave:W(T),persisted:""},{default:ee((()=>[ie(Y(W(ke),{"custom-mask-event":"",mask:e.modal,"overlay-class":e.modalClass,"z-index":W(F)},{default:ee((()=>[K("div",{role:"dialog","aria-modal":"true","aria-label":e.title||void 0,"aria-labelledby":e.title?void 0:W(_),"aria-describedby":W(I),class:Q(`${W(m).namespace.value}-overlay-dialog`),style:le(W(R)),onClick:o[0]||(o[0]=(...e)=>W(Z).onClick&&W(Z).onClick(...e)),onMousedown:o[1]||(o[1]=(...e)=>W(Z).onMousedown&&W(Z).onMousedown(...e)),onMouseup:o[2]||(o[2]=(...e)=>W(Z).onMouseup&&W(Z).onMouseup(...e))},[Y(W(E),{loop:"",trapped:W(g),"focus-start-el":"container",onFocusAfterTrapped:W(q),onFocusAfterReleased:W(U),onFocusoutPrevented:W(J),onReleaseRequested:W(X)},{default:ee((()=>[W(A)?(G(),oe(Be,ce({key:0,ref_key:"dialogContentRef",ref:v},e.$attrs,{"custom-class":e.customClass,center:e.center,"align-center":e.alignCenter,"close-icon":e.closeIcon,draggable:W(te),fullscreen:e.fullscreen,"show-close":e.showClose,title:e.title,onClose:W(z)}),pe({header:ee((()=>[e.$slots.title?N(e.$slots,"title",{key:1}):N(e.$slots,"header",{key:0,close:W(z),titleId:W(_),titleClass:W(m).e("title")})])),default:ee((()=>[N(e.$slots,"default")])),_:2},[e.$slots.footer?{name:"footer",fn:ee((()=>[N(e.$slots,"footer")]))}:void 0]),1040,["custom-class","center","align-center","close-icon","draggable","fullscreen","show-close","title","onClose"])):ae("v-if",!0)])),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,Fe)])),_:3},8,["mask","overlay-class","z-index"]),[[me,W(g)]])])),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]])),Le={class:"dialog-footer"},Te=q({__name:"MinPack",setup(e){let o=be(),t=ne(!1),a=ne(""),l=ne([]);const s=ve({id:parseInt(o.query.id)||0,type:o.query.type||"list",title:"赋码(最小包装)",name:"min_pack",limit:12,offset:0,domain:[],sort:"id desc",count:0,model:"srm.coding",fields:["name","supplier_id","default_code","product_name","produce_number","amount","min_pack_size","print_amount","if_print","date_from","shelf_life","manufacturer_id","comment","delivery_order_line_id","is_generate","state"],import_fields:["default_code","product_name","manufacturer_id","produce_number","shelf_life","date_from","amount","comment"],tables:{}}),n={buttons:[{type:"edit",text:"编辑",showType:["form"],attributes:{}},{type:"create",showType:["list","form"],text:"创建"},{type:"object",method:"print_code",showType:["form","list"],text:"打印",needRow:!0,attributes:{invisible:[["is_generate","=",!1]]}},{type:"import",showType:["list"],text:"导入",template:"/stock_manager/download_template/min",attributes:{}},{type:"custom",showType:["list"],text:"修改日期",needRow:!0,attributes:{}},{type:"object",method:"create_code",showType:["form"],text:"生成标签",attributes:{invisible:["|",["if_print","=",!0],["is_generate","=",!0]]}}],search_fields:{default_code:{domain:[]}},attributes:{default_code:{readonly:["|",["if_print","=",!0],["is_generate","=",!0]]},supplier_id:{readonly:["|",["if_print","=",!0],["is_generate","=",!0]],domain:[["supplier","=",!0],["parent_id","=",!1]]}},invisible:["is_generate","state","delivery_order_line_id"],readonly:["name","product_name","print_amount","name","if_print","min_pack_size","delivery_order_line_id"],required:["default_code","date_from","amount","min_pack_size","shelf_life","supplier_id","produce_number"]},r=(e,o,a,s)=>{if(!o.length)return R({message:"请至少选择一条记录!",type:"error"}),!1;l.value={ids:o,model:a,reload:s},t.value=!0},d=()=>{if(!a.value)return R({message:"请输入生产日期!",type:"error"}),!1;A({model:l.value.model,method:"update_date_from",args:[l.value.ids,{front:!0,date_from:a.value}]}).then((e=>{if(e.error)return R({message:e.error.data.message,type:"error"}),!1;l.value.reload(),t.value=!1}))},u=(e,o,t)=>{const a=t.result;a.ids&&(s.domain=s.domain.concat([["id","in",a.ids]]),he.replace({name:"min_pack"}))};return(e,o)=>{const l=F,i=S,c=$e;return G(),J(ge,null,[Y(c,{modelValue:W(t),"onUpdate:modelValue":o[2]||(o[2]=e=>D(t)?t.value=e:t=e),title:"修改生产日期",width:"30%",draggable:""},{footer:ee((()=>[K("span",Le,[Y(i,{onClick:o[1]||(o[1]=e=>D(t)?t.value=!1:t=!1)},{default:ee((()=>[_e("取消")])),_:1}),Y(i,{type:"primary",onClick:d},{default:ee((()=>[_e(" 保存 ")])),_:1})])])),default:ee((()=>[Y(l,{modelValue:W(a),"onUpdate:modelValue":o[0]||(o[0]=e=>D(a)?a.value=e:a=e),type:"date"},null,8,["modelValue"])])),_:1},8,["modelValue"]),Y(B,{params:s,extras:n,onCustomClick:r,onObjectBtnClick:u},null,8,["params"])],64)}}});export{Te as _};
