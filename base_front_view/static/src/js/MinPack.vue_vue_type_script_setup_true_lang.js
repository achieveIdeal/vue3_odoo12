import{R as e,E as t,c as a,h as r,j as i,v as o}from"./RecordView.js";import{E as s}from"./el-overlay.js";import{d as l,f as d,r as n,c as u,a as m,w as p,u as _,g as c,F as f,o as v,h as y,B as b,e as h,A as g,i as w}from"./index.js";const x={class:"dialog-footer"},k=l({__name:"MinPack",setup(l){const k=parseInt(w("supplier_id")||0);let V=d(!1),j=d(""),T=d([]);const C=d(!1),R=n({id:0,type:"list",title:"赋码(最小包装)",name:"min_pack",domain:[["supplier_id","=",k]],sort:"id desc",model:"srm.coding",fields:["name","supplier_id","produce_number","default_code","product_name","amount","min_pack_size","print_amount","date_from","shelf_life","manufacturer_id","comment","delivery_order_id","is_generate","if_print","state"],import_fields:["default_code","product_name","manufacturer_id","produce_number","shelf_life","date_from","amount","comment"],tables:{}}),z={buttons:[{type:"edit",text:"编辑",showType:["form"],attributes:{invisible:[["if_print","=",!0]]}},{type:"create",showType:["list","form"],text:"创建"},{type:"object",method:"print_code",showType:["form","list"],text:"打印",needRow:!0,attributes:{invisible:[["is_generate","=",!1]]}},{type:"import",showType:["list"],text:"导入",template:"/stock_manager/download_template/min",attributes:{}},{type:"custom",showType:["list"],text:"修改日期",needRow:!0,attributes:{}},{type:"object",method:"create_code",showType:["form"],text:"生成标签",attributes:{invisible:["|",["if_print","=",!0],["is_generate","=",!0]]}}],search_fields:{default_code:{domain:[],noSelect:!0}},attributes:{default_code:{readonly:["|",["if_print","=",!0],["is_generate","=",!0]]},supplier_id:{domain:[["supplier","=",!0],["parent_id","=",!1]]},name:{width:"200"}},invisible:["is_generate","state","delivery_order_id"],listInvisible:["supplier_id","shelf_life","manufacturer_id","produce_number","comment"],readonly:["name","product_name","print_amount","name","supplier_id","if_print","delivery_order_id","shelf_life"],required:["default_code","date_from","amount","min_pack_size","produce_number"]},E=(e,a,r)=>{const i=a.map((e=>e.id));if(!i.length)return t({message:"请至少选择一条记录!",type:"error"}),!1;T.value={ids:i,reload:r},V.value=!0},I=()=>{if(!j.value)return t({message:"请输入生产日期!",type:"error"}),!1;C.value=!0,a({model:R.model,method:"update_date_from",args:[T.value.ids,{front:!0,date_from:j.value}]}).then((e=>{if(e.error)return C.value=!1,t({message:e.error.data.message,type:"error"}),!1;T.value.reload(),C.value=!1,V.value=!1}))};return(t,a)=>{const l=r,d=i,n=s,w=o;return v(),u(f,null,[m(n,{modelValue:_(V),"onUpdate:modelValue":a[2]||(a[2]=e=>c(V)?V.value=e:V=e),title:"修改生产日期",width:"30%",draggable:""},{footer:p((()=>[y("span",x,[b((v(),h(d,{"element-loading-text":"正在加载...",onClick:a[1]||(a[1]=e=>c(V)?V.value=!1:V=!1)},{default:p((()=>[g("取消")])),_:1})),[[w,C.value,void 0,{fullscreen:!0,lock:!0}]]),m(d,{type:"primary",onClick:I},{default:p((()=>[g(" 保存 ")])),_:1})])])),default:p((()=>[m(l,{modelValue:_(j),"onUpdate:modelValue":a[0]||(a[0]=e=>c(j)?j.value=e:j=e),type:"date"},null,8,["modelValue"])])),_:1},8,["modelValue"]),m(e,{params:R,extras:z,onCustomClick:E},null,8,["params"])],64)}}});export{k as _};
